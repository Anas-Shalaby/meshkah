# ูุธุงู ุงูุชูุตูุงุช ุงูุฐููุฉ - ูุดูุงุฉ ุงูุญุฏูุซ ุงูุดุฑูู

## ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุงูุชูุตูุงุช ุงูุฐููุฉ ูู ูุธุงู ูุชูุฏู ูุชูุฏูู ุชูุตูุงุช ูุฎุตุตุฉ ููุฃุญุงุฏูุซ ุจูุงุกู ุนูู ุฃููุงุท ูุฑุงุกุฉ ุงููุณุชุฎุฏู ูุชูุงุนูุงุชู ูุน ุงููุญุชูู.

## ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

### ๐ฏ ุงูุชูุตูุงุช ุงูุฐููุฉ

- **ุชูุตูุงุช ุงููุญุชูู ุงููุดุงุจู**: ุจูุงุกู ุนูู ุงูุฃุญุงุฏูุซ ุงูุชู ูุฑุฃูุง ุงููุณุชุฎุฏู ุณุงุจูุงู
- **ุงูุชูุตูุงุช ุงูุดุงุฆุนุฉ**: ุงูุฃุญุงุฏูุซ ุงูุฃูุซุฑ ุดุนุจูุฉ ุจูู ุงููุณุชุฎุฏููู
- **ุงูุชูุตูุงุช ุงููุฎุตุตุฉ**: ูุจููุฉ ุนูู ุฃููุงุท ุงููุฑุงุกุฉ ุงูุดุฎุตูุฉ

### ๐ ุชุญููู ุฃููุงุท ุงููุณุชุฎุฏู

- **ุงูููุงุถูุน ุงูููุถูุฉ**: ุชุญููู ุงูููุงุถูุน ุงูุชู ููุชู ุจูุง ุงููุณุชุฎุฏู
- **ุฃููุงุช ุงููุฑุงุกุฉ**: ุชุญููู ุงูุฃููุงุช ุงูููุถูุฉ ูููุฑุงุกุฉ
- **ุชูุถููุงุช ุงูุตุนูุจุฉ**: ุชุญููู ูุณุชูู ุงูุตุนูุจุฉ ุงูููุถู
- **ุชุชุจุน ุงูุชูุงุนูุงุช**: ุชุณุฌูู ุฌููุน ุชูุงุนูุงุช ุงููุณุชุฎุฏู ูุน ุงูุฃุญุงุฏูุซ

### ๐ค ุงูุฎูุงุฑุฒููุงุช ุงูุฐููุฉ

- **ุฎูุงุฑุฒููุฉ ุงููุญุชูู ุงููุดุงุจู**: ุชุญููู ุงููุญุชูู ูุฑุจุทู ุจุงูููุงุถูุน ุงูููุถูุฉ
- **ุฎูุงุฑุฒููุฉ ุงูุดุนุจูุฉ**: ุชุฑุชูุจ ุงูุฃุญุงุฏูุซ ุจูุงุกู ุนูู ุงูุดุนุจูุฉ ูุงูุฅุญุตุงุฆูุงุช
- **ุฎูุงุฑุฒููุฉ ุงูุชุฎุตูุต**: ุชุญููู ุฃููุงุท ุงููุณุชุฎุฏู ูุชูุฏูู ุชูุตูุงุช ูุฎุตุตุฉ

## ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงูุฌุฏุงูู ุงูุฌุฏูุฏุฉ

#### 1. `user_hadith_interactions`

ุชุชุจุน ุชูุงุนู ุงููุณุชุฎุฏู ูุน ุงูุฃุญุงุฏูุซ:

```sql
- user_id: ูุนุฑู ุงููุณุชุฎุฏู
- hadith_id: ูุนุฑู ุงูุญุฏูุซ
- interaction_type: ููุน ุงูุชูุงุนู (view, read, bookmark, memorize, share, like, analyze)
- duration_seconds: ูุฏุฉ ุงูุชูุงุนู
- rating: ุชูููู ุงููุณุชุฎุฏู (1-5)
- notes: ููุงุญุธุงุช ุงููุณุชุฎุฏู
- source_page: ุงูุตูุญุฉ ุงููุตุฏุฑ
- device_type: ููุน ุงูุฌูุงุฒ
```

#### 2. `smart_recommendations`

ุชุฎุฒูู ุงูุชูุตูุงุช ุงูุฐููุฉ:

```sql
- user_id: ูุนุฑู ุงููุณุชุฎุฏู
- hadith_id: ูุนุฑู ุงูุญุฏูุซ
- recommendation_type: ููุน ุงูุชูุตูุฉ (similar_content, trending, personalized, completion, discovery)
- confidence_score: ุฏุฑุฌุฉ ุงูุซูุฉ (0.00-1.00)
- reason: ุณุจุจ ุงูุชูุตูุฉ
- algorithm_version: ุฅุตุฏุงุฑ ุงูุฎูุงุฑุฒููุฉ
- is_viewed: ูู ุชู ุนุฑุถ ุงูุชูุตูุฉ
- is_clicked: ูู ุชู ุงูููุฑ ุนูู ุงูุชูุตูุฉ
- feedback_rating: ุชูููู ุงููุณุชุฎุฏู ููุชูุตูุฉ
```

#### 3. `user_reading_patterns`

ุฃููุงุท ูุฑุงุกุฉ ุงููุณุชุฎุฏู:

```sql
- user_id: ูุนุฑู ุงููุณุชุฎุฏู
- pattern_type: ููุน ุงูููุท (preferred_topics, reading_time, interaction_frequency, difficulty_preference)
- pattern_data: ุจูุงูุงุช ุงูููุท (JSON)
- confidence_level: ูุณุชูู ุงูุซูุฉ
```

#### 4. `hadith_statistics`

ุฅุญุตุงุฆูุงุช ุงูุฃุญุงุฏูุซ:

```sql
- hadith_id: ูุนุฑู ุงูุญุฏูุซ
- total_views: ุฅุฌูุงูู ุงููุดุงูุฏุงุช
- total_reads: ุฅุฌูุงูู ุงููุฑุงุกุงุช
- total_bookmarks: ุฅุฌูุงูู ุงูุฅุดุงุฑุงุช ุงููุฑุฌุนูุฉ
- total_memorizations: ุฅุฌูุงูู ุงูุญูุธ
- average_rating: ูุชูุณุท ุงูุชูููู
- average_reading_time: ูุชูุณุท ููุช ุงููุฑุงุกุฉ
- popularity_score: ุฏุฑุฌุฉ ุงูุดุนุจูุฉ
```

## API Endpoints

### 1. ุชุชุจุน ุงูุชูุงุนู

```http
POST /api/recommendations/track-interaction
```

**Body:**

```json
{
  "hadithId": 123,
  "interactionType": "read",
  "metadata": {
    "duration_seconds": 45,
    "rating": 4,
    "notes": "ุญุฏูุซ ูููุฏ ุฌุฏุงู",
    "source_page": "hadith-page",
    "device_type": "mobile"
  }
}
```

### 2. ุงูุญุตูู ุนูู ุงูุชูุตูุงุช ุงูุฐููุฉ

```http
GET /api/recommendations/smart-recommendations?limit=10&type=all
```

### 3. ุชูููุฏ ุชูุตูุงุช ุฌุฏูุฏุฉ

```http
POST /api/recommendations/generate-recommendations
```

**Body:**

```json
{
  "limit": 15
}
```

### 4. ุชุชุจุน ุชูุงุนู ุงูุชูุตูุฉ

```http
POST /api/recommendations/track-recommendation-interaction
```

**Body:**

```json
{
  "recommendationId": 456,
  "interactionType": "click"
}
```

### 5. ุชูููู ุงูุชูุตูุฉ

```http
POST /api/recommendations/rate-recommendation
```

**Body:**

```json
{
  "recommendationId": 456,
  "rating": 4
}
```

### 6. ุงูุญุตูู ุนูู ุฃููุงุท ุงููุฑุงุกุฉ

```http
GET /api/recommendations/reading-patterns
```

### 7. ุฅุญุตุงุฆูุงุช ุงููุณุชุฎุฏู

```http
GET /api/recommendations/user-stats
```

## ุงูููุงู ุงููุฌุฏููุฉ (Schedulers)

### 1. ุชุญุฏูุซ ุงูุชูุตูุงุช (ูู 6 ุณุงุนุงุช)

```javascript
cron.schedule("0 */6 * * *", async () => {
  await recommendationService.updateRecommendationsForAllUsers();
});
```

### 2. ุชูุธูู ุงูุชูุตูุงุช ุงููุฏููุฉ (ููููุงู ูู 2 ุตุจุงุญุงู)

```javascript
cron.schedule("0 2 * * *", async () => {
  // ุญุฐู ุงูุชูุตูุงุช ุงูููุชููุฉ ุงูุตูุงุญูุฉ
});
```

### 3. ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงูุฃุญุงุฏูุซ (ูู ุณุงุนุฉ)

```javascript
cron.schedule("0 * * * *", async () => {
  // ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุฌููุน ุงูุฃุญุงุฏูุซ
});
```

### 4. ุชุญููู ุฃููุงุท ุงููุณุชุฎุฏููู (ูู 12 ุณุงุนุฉ)

```javascript
cron.schedule("0 */12 * * *", async () => {
  // ุชุญููู ุฃููุงุท ุงููุณุชุฎุฏููู ุงููุดุทูู
});
```

## ุงูุชุซุจูุช ูุงูุฅุนุฏุงุฏ

### 1. ุชุดุบูู Migrations

```bash
cd backend
node scripts/run-recommendation-migrations.js
```

### 2. ุชุซุจูุช Dependencies ุงููุทููุจุฉ

```bash
npm install node-cron
```

### 3. ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู

```bash
npm start
```

## ุงูุงุณุชุฎุฏุงู ูู Frontend

### 1. ุชุชุจุน ุชูุงุนู ุงููุณุชุฎุฏู

```javascript
// ุนูุฏ ูุฑุงุกุฉ ุญุฏูุซ
await fetch("/api/recommendations/track-interaction", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "x-auth-token": token,
  },
  body: JSON.stringify({
    hadithId: hadith.id,
    interactionType: "read",
    metadata: {
      duration_seconds: readingTime,
      rating: userRating,
      device_type: "mobile",
    },
  }),
});
```

### 2. ุงูุญุตูู ุนูู ุงูุชูุตูุงุช

```javascript
// ุฌูุจ ุงูุชูุตูุงุช ุงูุฐููุฉ
const response = await fetch(
  "/api/recommendations/smart-recommendations?limit=10",
  {
    headers: {
      "x-auth-token": token,
    },
  }
);
const { recommendations } = await response.json();
```

### 3. ุชุชุจุน ุชูุงุนู ุงูุชูุตูุฉ

```javascript
// ุนูุฏ ุงูููุฑ ุนูู ุชูุตูุฉ
await fetch("/api/recommendations/track-recommendation-interaction", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "x-auth-token": token,
  },
  body: JSON.stringify({
    recommendationId: recommendation.id,
    interactionType: "click",
  }),
});
```

## ุงูุฎูุงุฑุฒููุงุช ุงููุณุชุฎุฏูุฉ

### 1. ุฎูุงุฑุฒููุฉ ุงููุญุชูู ุงููุดุงุจู

- ุชุญููู ุงูููุงุถูุน ุงูููุถูุฉ ูููุณุชุฎุฏู
- ุงูุจุญุซ ุนู ุฃุญุงุฏูุซ ุจููุณ ุงูููุงุถูุน
- ุชุฑุชูุจ ุญุณุจ ุฏุฑุฌุฉ ุงูุดุนุจูุฉ

### 2. ุฎูุงุฑุฒููุฉ ุงูุดุนุจูุฉ

- ุญุณุงุจ ุฏุฑุฌุฉ ุงูุดุนุจูุฉ ุจูุงุกู ุนูู:
  - ุนุฏุฏ ุงููุดุงูุฏุงุช (ูุฒู 0.1)
  - ุนุฏุฏ ุงููุฑุงุกุงุช (ูุฒู 0.3)
  - ุนุฏุฏ ุงูุฅุดุงุฑุงุช ุงููุฑุฌุนูุฉ (ูุฒู 0.4)
  - ุนุฏุฏ ุงูุญูุธ (ูุฒู 0.5)
  - ูุชูุณุท ุงูุชูููู (ูุฒู 2.0)

### 3. ุฎูุงุฑุฒููุฉ ุงูุชุฎุตูุต

- ุชุญููู ุฃููุงุท ุงููุฑุงุกุฉ ุงูุดุฎุตูุฉ
- ุฑุจุท ุงูููุงุถูุน ุงูููุถูุฉ ุจูุณุชูู ุงูุตุนูุจุฉ
- ุชุฑุชูุจ ุงูุชูุตูุงุช ุญุณุจ ุฏุฑุฌุฉ ุงูุซูุฉ

## ุงููุฑุงูุจุฉ ูุงูุตูุงูุฉ

### 1. ูุฑุงูุจุฉ ุงูุฃุฏุงุก

- ูุฑุงูุจุฉ ุนุฏุฏ ุงูุชูุตูุงุช ุงููููุฏุฉ
- ุชุชุจุน ูุนุฏูุงุช ุงูููุฑ ุนูู ุงูุชูุตูุงุช
- ูุฑุงูุจุฉ ุฏูุฉ ุงูุชูุตูุงุช

### 2. ุงูุตูุงูุฉ ุงูุฏูุฑูุฉ

- ุชูุธูู ุงูุชูุตูุงุช ุงููุฏููุฉ
- ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงูุฃุญุงุฏูุซ
- ุชุญููู ุฃููุงุท ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ

### 3. ุงูุชุญุณูู ุงููุณุชูุฑ

- ุชุญููู ุชููููุงุช ุงููุณุชุฎุฏููู ููุชูุตูุงุช
- ุชุญุณูู ุงูุฎูุงุฑุฒููุงุช ุจูุงุกู ุนูู ุงูุจูุงูุงุช
- ุฅุถุงูุฉ ุฃููุงุน ุชูุตูุงุช ุฌุฏูุฏุฉ

## ุงูุฃูุงู ูุงูุฎุตูุตูุฉ

- ุฌููุน ุงูุจูุงูุงุช ูุญููุธุฉ ูุญููุงู
- ูุง ูุชู ูุดุงุฑูุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู ูุน ุฃุทุฑุงู ุซุงูุซุฉ
- ุงูุชูุตูุงุช ูุจููุฉ ุนูู ุงูุจูุงูุงุช ุงููุฌูุนุฉ ููุท
- ุฅููุงููุฉ ุญุฐู ุจูุงูุงุช ุงููุณุชุฎุฏู ุนูุฏ ุงูุทูุจ

## ุงูุฏุนู ูุงููุณุงุนุฏุฉ

ูููุณุงุนุฏุฉ ุฃู ุงูุงุณุชูุณุงุฑุงุช ุญูู ูุธุงู ุงูุชูุตูุงุช ุงูุฐููุฉุ ูุฑุฌู ุงูุชูุงุตู ูุน ูุฑูู ุงูุชุทููุฑ.
